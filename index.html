<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>FoxiGrow Clone - Mustafa Alaa</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg: #050505;
            --card-bg: #111111;
            --primary: #ff9900;
            --secondary: #00ffcc;
            --accent: #f39c12;
            --border: rgba(255, 255, 255, 0.08);
        }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; margin: 0; padding: 0; }
        body { font-family: 'Cairo', sans-serif; background: var(--bg); color: #fff; overflow: hidden; height: 100vh; }
        
        /* Views System */
        .view { display: none; height: calc(100vh - 80px); overflow-y: auto; padding: 20px; }
        .view.active { display: block; animation: fadeIn 0.3s ease; }

        /* Top Header */
        .header { display: flex; justify-content: space-between; align-items: center; padding: 15px 20px; }
        .user-meta { display: flex; align-items: center; gap: 10px; }
        .avatar { width: 45px; height: 45px; border-radius: 50%; background: linear-gradient(45deg, var(--primary), #e67e22); border: 2px solid var(--border); display: flex; align-items: center; justify-content: center; font-weight: 800; }
        .lvl-badge { background: rgba(255,153,0,0.1); border: 1px solid var(--primary); color: var(--primary); padding: 1px 10px; border-radius: 12px; font-size: 0.7rem; }

        /* Stats Grid (Top 3 Cards) */
        .stats-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-bottom: 20px; }
        .stat-card { background: var(--card-bg); border-radius: 18px; padding: 15px 5px; text-align: center; border: 1px solid var(--border); }
        .stat-card .val { display: block; font-size: 1.3rem; font-weight: 800; margin-bottom: 5px; }
        .stat-card .label { font-size: 0.65rem; color: #888; }

        /* Action Boxes (Middle Rows) */
        .action-box { background: var(--card-bg); border-radius: 20px; padding: 18px; margin-bottom: 15px; border: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center; }
        .icon-sq { width: 45px; height: 45px; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; }

        /* Task Section */
        .task-list-title { padding: 10px 5px; color: #888; font-size: 0.85rem; display: flex; justify-content: space-between; }
        .hot-task { background: var(--card-bg); border-radius: 20px; padding: 20px; border: 1px solid var(--border); position: relative; }
        .btn-join { background: #0088cc; border: none; color: #fff; width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; }

        /* Navigation Bar */
        .nav-bar { position: fixed; bottom: 0; left: 0; right: 0; background: rgba(10,10,10,0.95); display: flex; justify-content: space-around; padding: 12px 0; border-top: 1px solid var(--border); backdrop-filter: blur(10px); }
        .nav-item { flex: 1; text-align: center; color: #666; font-size: 0.7rem; cursor: pointer; }
        .nav-item.active { color: var(--primary); }
        .nav-item span { display: block; margin-top: 4px; }

        /* Global UI */
        .glow-orange { color: var(--primary); text-shadow: 0 0 15px rgba(255,153,0,0.3); }
        .glow-green { color: var(--secondary); text-shadow: 0 0 15px rgba(0,255,204,0.3); }
        #loader { position: fixed; inset: 0; background: #000; z-index: 9999; display: flex; flex-direction: column; justify-content: center; align-items: center; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body>

    <div id="loader">
        <div style="width: 40px; height: 40px; border: 3px solid #222; border-top-color: var(--primary); border-radius: 50%; animation: spin 1s infinite linear;"></div>
        <p style="margin-top:20px; color:#555;">FoxiGrow Clone v1.0</p>
    </div>

    <div id="home" class="view active">
        <div class="header">
            <div class="user-meta">
                <div class="avatar" id="avatar">M</div>
                <div>
                    <h4 id="user-display">Mustafa Alaa</h4>
                    <div class="lvl-badge">Ù…Ø¨ØªØ¯Ø¦ â€¢ LV.2</div>
                </div>
            </div>
            <div style="font-size: 1.5rem;">âš™ï¸</div>
        </div>

        <div class="stats-grid">
            <div class="stat-card">
                <span class="val" style="color: #ff4d00;">6</span>
                <span class="label">Ù…ÙƒØªÙ…Ù„</span>
            </div>
            <div class="stat-card" style="border-color: var(--primary);">
                <span class="val glow-orange" id="fg-balance">0.00</span>
                <span class="label">FG coin</span>
            </div>
            <div class="stat-card">
                <span class="val glow-green" id="usdt-balance">0.00</span>
                <span class="label">USDT</span>
            </div>
        </div>

        <div class="action-box">
            <div>
                <h4 style="margin:0">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø¶ÙˆØ± Ø§Ù„ÙŠÙˆÙ…ÙŠ</h4>
                <p style="font-size:0.75rem; color:#666; margin-top:4px;">Ø¥Ø¬Ù…Ø§Ù„ÙŠ <span id="total-days">0</span> ÙŠÙˆÙ… | ØªØ³Ù„Ø³Ù„ <span id="streak-days">0</span> ÙŠÙˆÙ…</p>
            </div>
            <div class="icon-sq" style="background: #f1c40f; color:#000;" onclick="handleDaily()">ğŸ’°</div>
        </div>

        <div class="action-box" style="border-style: dashed;">
            <div>
                <h4 style="margin:0">Ø§Ù„Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø±Ø³Ù…ÙŠ</h4>
                <p style="font-size:0.75rem; color:#666; margin-top:4px;">ØªØ¹Ù„Ù… ÙƒÙŠÙÙŠØ© ÙƒØ³Ø¨ Ø§Ù„Ù…ÙƒØ§ÙØ¢Øª</p>
            </div>
            <div class="icon-sq" style="background: rgba(255,255,255,0.05);">ğŸ“–</div>
        </div>

        <div class="task-list-title">
            <span>ğŸ”¥ Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ø³Ø§Ø®Ù†Ø©</span>
            <span style="color:var(--primary)">Ø¹Ø±Ø¶ Ø§Ù„ÙƒÙ„ ></span>
        </div>

        <div class="hot-task">
            <div style="display:flex; justify-content:space-between; align-items:center;">
                <div>
                    <span style="background: #9b59b6; padding: 2px 10px; border-radius: 8px; font-size: 0.7rem;">Ø¬Ø¯ÙŠØ¯</span>
                    <h4 style="margin:10px 0 5px;">Ø§Ù†Ø¶Ù… Ø¥Ù„Ù‰ Ù‚Ù†Ø§Ø© @FoxiGrow</h4>
                    <p style="font-size:0.8rem; color:#888;">0.2+ ğŸª™ | 0.02+ ğŸ’µ</p>
                </div>
                <button class="btn-join" onclick="window.open('https://t.me/tofe109tofebot')">ğŸš€</button>
            </div>
        </div>
    </div>

    <div id="tasks" class="view"><h2>ØµÙØ­Ø© Ø§Ù„Ù…Ù‡Ø§Ù…</h2><p>Ø³ÙŠØªÙ… ØªÙØ¹ÙŠÙ„ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù‡Ø§Ù… Ù‡Ù†Ø§.</p></div>
    <div id="ranking" class="view"><h2>Ø§Ù„ØªØµÙ†ÙŠÙ</h2><p>Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…ØªØµØ¯Ø±ÙŠÙ† Ø³ØªØ¸Ù‡Ø± Ù‚Ø±ÙŠØ¨Ø§Ù‹.</p></div>
    <div id="activity" class="view"><h2>Ø§Ù„Ù†Ø´Ø§Ø·</h2><p>ØªØ§Ø±ÙŠØ® Ø­Ø±ÙƒØ§Øª Ø­Ø³Ø§Ø¨Ùƒ.</p></div>
    <div id="profile" class="view"><h2>Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ</h2><p>ØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø³Ø§Ø¨.</p></div>

    <nav class="nav-bar">
        <div class="nav-item active" onclick="switchView('home')">ğŸ <span>Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</span></div>
        <div class="nav-item" onclick="switchView('tasks')">ğŸ¯<span>Ø§Ù„Ù…Ù‡Ø§Ù…</span></div>
        <div class="nav-item" onclick="switchView('ranking')">ğŸ†<span>Ø§Ù„ØªØµÙ†ÙŠÙ</span></div>
        <div class="nav-item" onclick="switchView('activity')">ğŸ“Š<span>Ø§Ù„Ù†Ø´Ø§Ø·</span></div>
        <div class="nav-item" onclick="switchView('profile')">ğŸ‘¤<span>Ø§Ù„Ù…Ù„Ù</span></div>
    </nav>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
        import { getFirestore, doc, getDoc, setDoc, onSnapshot, increment, updateDoc } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyD5YAKC8KO5jKHQdsdrA8Bm-ERD6yUdHBQ",
            authDomain: "tele-follow.firebaseapp.com",
            projectId: "tele-follow",
            storageBucket: "tele-follow.firebasestorage.app",
            messagingSenderId: "311701431089",
            appId: "1:311701431089:web:fcba431dcae893a87cc610"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const tg = window.Telegram.WebApp;

        let userId = tg.initDataUnsafe?.user?.id?.toString() || "dev_user_99";
        const userRef = doc(db, "users", userId);

        async function initApp() {
            try {
                const snap = await getDoc(userRef);
                if (!snap.exists()) {
                    await setDoc(userRef, {
                        name: tg.initDataUnsafe?.user?.first_name || "Mustafa",
                        balance_fg: 8.1,
                        balance_usdt: 0.23,
                        total_days: 2,
                        streak_days: 2,
                        level: 2
                    });
                }

                onSnapshot(userRef, (d) => {
                    const data = d.data();
                    document.getElementById('fg-balance').innerText = data.balance_fg.toFixed(2);
                    document.getElementById('usdt-balance').innerText = data.balance_usdt.toFixed(2);
                    document.getElementById('total-days').innerText = data.total_days;
                    document.getElementById('streak-days').innerText = data.streak_days;
                    document.getElementById('user-display').innerText = data.name;
                    document.getElementById('avatar').innerText = data.name.charAt(0);
                });

                document.getElementById('loader').style.display = 'none';
            } catch (e) {
                alert("ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Firestore Rules Ù‡ÙŠ allow read, write: if true;");
            }
        }

        window.switchView = (viewId) => {
            document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
            document.getElementById(viewId).classList.add('active');
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.toggle('active', item.getAttribute('onclick').includes(viewId));
            });
            tg.HapticFeedback.selectionChanged();
        };

        window.handleDaily = async () => {
            tg.showConfirm("Ù‡Ù„ ØªØ±ÙŠØ¯ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø¶ÙˆØ± Ø§Ù„ÙŠÙˆÙ…ØŸ", async (ok) => {
                if (ok) {
                    await updateDoc(userRef, {
                        balance_fg: increment(0.1),
                        streak_days: increment(1)
                    });
                    tg.showAlert("ØªÙ… Ø§Ø³ØªÙ„Ø§Ù… Ù…ÙƒØ§ÙØ£Ø© Ø§Ù„Ø­Ø¶ÙˆØ±! +0.1 FG");
                }
            });
        };

        tg.ready(); tg.expand(); initApp();
    </script>
    <style>@keyframes spin { 100% { transform: rotate(360deg); } }</style>
</body>
</html>
