<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>FoxiGrow - Mustafa Alaa</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-dark: #050505;
            --card-bg: rgba(255, 255, 255, 0.05);
            --primary-glow: #ff9900;
            --secondary-glow: #00ffcc;
            --border: rgba(255, 255, 255, 0.1);
        }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; user-select: none; }
        body {
            font-family: 'Cairo', sans-serif;
            background-color: var(--bg-dark);
            background-image: radial-gradient(circle at 50% 10%, #1a1a1a, #000);
            color: #fff; margin: 0; padding-bottom: 80px;
        }
        .header { padding: 20px; display: flex; justify-content: space-between; align-items: center; }
        .avatar { width: 45px; height: 45px; border-radius: 50%; background: linear-gradient(45deg, #ff9900, #ff4d00); display: flex; align-items: center; justify-content: center; font-weight: 800; border: 2px solid var(--border); }
        .stats-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; padding: 15px; }
        .stat-card { background: var(--card-bg); border: 1px solid var(--border); border-radius: 18px; padding: 15px 5px; text-align: center; backdrop-filter: blur(10px); }
        .stat-card.active { border-color: var(--primary-glow); box-shadow: 0 0 15px rgba(255,153,0,0.15); }
        .stat-card .val { font-size: 1.2rem; font-weight: 800; display: block; }
        .stat-card .label { font-size: 0.65rem; color: #888; }
        .action-card { background: var(--card-bg); margin: 10px 15px; padding: 20px; border-radius: 20px; border: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center; }
        .btn-claim { background: var(--primary-glow); border: none; color: #fff; padding: 10px 20px; border-radius: 12px; font-weight: bold; cursor: pointer; }
        .nav-bar { position: fixed; bottom: 0; left: 0; right: 0; background: rgba(10, 10, 10, 0.95); display: flex; justify-content: space-around; padding: 15px; border-top: 1px solid var(--border); }
        .nav-item { color: #555; font-size: 0.7rem; text-align: center; text-decoration: none; }
        .nav-item.active { color: var(--primary-glow); }
        #loader { position: fixed; inset: 0; background: #000; z-index: 9999; display: flex; flex-direction: column; justify-content: center; align-items: center; }
        .glow-orange { color: #ff9900; text-shadow: 0 0 10px rgba(255,153,0,0.5); }
        .glow-green { color: #00ffcc; text-shadow: 0 0 10px rgba(0,255,204,0.5); }
    </style>
</head>
<body>

    <div id="loader">
        <div style="width: 40px; height: 40px; border: 4px solid #222; border-top-color: var(--primary-glow); border-radius: 50%; animation: spin 1s infinite linear;"></div>
        <p style="color: #666; margin-top: 15px;">ÙŠØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ« Ù…Ù† Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ø§Ù„Ø¬Ø¯ÙŠØ¯...</p>
    </div>

    <header class="header">
        <div style="display: flex; align-items: center; gap: 10px;">
            <div class="avatar" id="avatar">M</div>
            <div>
                <div style="font-weight: 800;" id="username">Mustafa Alaa</div>
                <div style="font-size: 0.7rem; color: var(--primary-glow);">LV.2 Ù…Ø¨ØªØ¯Ø¦ ğŸ”¥</div>
            </div>
        </div>
        <div style="font-size: 1.5rem;">âš™ï¸</div>
    </header>

    <div class="stats-grid">
        <div class="stat-card">
            <span class="val" style="color: #ff4d00;">6</span>
            <span class="label">Ù…ÙƒØªÙ…Ù„</span>
        </div>
        <div class="stat-card active">
            <span class="val glow-orange" id="fg-balance">0.00</span>
            <span class="label">FG Coin</span>
        </div>
        <div class="stat-card">
            <span class="val glow-green" id="usdt-balance">0.00</span>
            <span class="label">USDT</span>
        </div>
    </div>

    <div class="action-card">
        <div>
            <h4 style="margin:0">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø¶ÙˆØ± Ø§Ù„ÙŠÙˆÙ…ÙŠ</h4>
            <p style="margin:5px 0 0; font-size:0.75rem; color:#666;">Ø§Ø¶ØºØ· Ù„Ø¬Ù…Ø¹ Ø§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„ÙŠÙˆÙ…ÙŠØ©</p>
        </div>
        <button class="btn-claim" onclick="addPoints()">Ø§Ø³ØªÙ„Ø§Ù…</button>
    </div>

    <nav class="nav-bar">
        <div class="nav-item active">ğŸ <br>Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</div>
        <div class="nav-item">ğŸ¯<br>Ø§Ù„Ù…Ù‡Ø§Ù…</div>
        <div class="nav-item">ğŸ†<br>Ø§Ù„ØªØµÙ†ÙŠÙ</div>
        <div class="nav-item">ğŸ‘¤<br>Ø§Ù„Ù…Ù„Ù</div>
    </nav>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
        import { getFirestore, doc, getDoc, setDoc, onSnapshot, increment, updateDoc } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

        // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ù…Ø´Ø±ÙˆØ¹Ùƒ Ø§Ù„Ø¬Ø¯ÙŠØ¯ (tele-follow)
        const firebaseConfig = {
            apiKey: "AIzaSyD5YAKC8KO5jKHQdsdrA8Bm-ERD6yUdHBQ",
            authDomain: "tele-follow.firebaseapp.com",
            projectId: "tele-follow",
            storageBucket: "tele-follow.firebasestorage.app",
            messagingSenderId: "311701431089",
            appId: "1:311701431089:web:fcba431dcae893a87cc610",
            measurementId: "G-N38SCYC5WV"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const tg = window.Telegram.WebApp;

        let userId = tg.initDataUnsafe?.user?.id?.toString() || "dev_user";
        const userRef = doc(db, "users", userId);

        async function init() {
            try {
                const snap = await getDoc(userRef);
                if (!snap.exists()) {
                    await setDoc(userRef, {
                        name: tg.initDataUnsafe?.user?.first_name || "Mustafa",
                        balance_fg: 8.1,
                        balance_usdt: 0.23,
                        level: 2
                    });
                }

                onSnapshot(userRef, (doc) => {
                    if (doc.exists()) {
                        const data = doc.data();
                        document.getElementById('fg-balance').innerText = data.balance_fg.toFixed(2);
                        document.getElementById('usdt-balance').innerText = data.balance_usdt.toFixed(2);
                        document.getElementById('username').innerText = data.name;
                        document.getElementById('avatar').innerText = data.name.charAt(0);
                    }
                });

                document.getElementById('loader').style.display = 'none';
            } catch (e) {
                alert("Ø®Ø·Ø£: ØªØ£ÙƒØ¯ Ù…Ù† ØªÙØ¹ÙŠÙ„ Firestore Rules Ø¥Ù„Ù‰ true");
            }
        }

        window.addPoints = async () => {
            await updateDoc(userRef, { balance_fg: increment(1.0) });
            tg.HapticFeedback.impactOccurred('medium');
        };

        tg.ready();
        tg.expand();
        init();
    </script>
    <style>@keyframes spin { 100% { transform: rotate(360deg); } }</style>
</body>
</html>
